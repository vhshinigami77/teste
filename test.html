<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Upload e Download de FFT e Amplitude</title>
</head>
<body>
  <h1>Enviar Áudio</h1>
  <input type="file" id="audioInput" accept="audio/*" />
  <button id="sendBtn">Enviar</button>

  <h2>Links para Download:</h2>
  <div id="downloadLinks"></div>

  <script>
    const sendBtn = document.getElementById('sendBtn');
    const audioInput = document.getElementById('audioInput');
    const downloadLinks = document.getElementById('downloadLinks');

    sendBtn.onclick = async () => {
      if (!audioInput.files.length) {
        alert('Selecione um arquivo de áudio primeiro.');
        return;
      }

      const file = audioInput.files[0];
      const formData = new FormData();
      formData.append('audio', file);

      downloadLinks.innerHTML = 'Enviando...';

      try {
        const res = await fetch('https://teste-fb8o.onrender.com/upload', {
          method: 'POST',
          body: formData,
        });

        if (!res.ok) {
          throw new Error(`Erro no upload: ${res.statusText}`);
        }

        const data = await res.json();

        downloadLinks.innerHTML = `
          <p><a href="https://teste-fb8o.onrender.com${data.downloads.amplitude}" target="_blank" download>Download Amplitude (.txt)</a></p>
          <p><a href="https://teste-fb8o.onrender.com${data.downloads.fft}" target="_blank" download>Download FFT (.txt)</a></p>
        `;
      } catch (err) {
        downloadLinks.innerHTML = 'Erro: ' + err.message;
      }
    };
  </script>
</body>
</html>
